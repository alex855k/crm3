!function(){if(!window.moment)throw new Error("moment.js not found; please place it in the global scope.");if(!window.jQuery&&!window.$)throw new Error("jQuery not found; please place it in the global scope.");var e=function(e){var t;switch(e){case"sv":case"se":t={OPEN_PICKER_SINGLE:"Välj vecka...",OPEN_PICKER:"Välj veckor...",CLEAR:"Rensa",NUM_SELECTED:"$num_selected veckor valda",WEEK_SELECTED:"Vecka $weeknum, $year"};break;case"en":default:t={OPEN_PICKER_SINGLE:"Choose a week...",OPEN_PICKER:"Open picker...",CLEAR:"Clear",NUM_SELECTED:"$num_selected weeks selected",WEEK_SELECTED:"Week $weeknum, $year"}}return t},t=function(e,t){return i().year(t).isoWeek(e).format("YYYY-MM-DD")},a=window.jQuery||window.$,i=window.moment;a.fn.weekPicker=function(n){var r=this,s=arguments,c={init:function(){var n=this,r=a(this);r.empty();var s=this.weekPicker.mode=r.data("mode")||"multi",c=e(r.data("locale"));r.append("<div class='_week-picker'><input readonly placeholder='"+("single"==s?c.OPEN_PICKER_SINGLE:c.OPEN_PICKER)+"' /><div class='_middle'><div class='_popup' style='display:none'><div class='_oh'><a href='javascript:void(0)' class='_arrow _left'>&lt;</a><p class='_yeardisp' /><a href='javascript:void(0)' class='_arrow _right'>&gt;</a></div><table class='_weekTable' /><div class='_uh'><a class='_clear' href='javascript:void(0)'>"+c.CLEAR+"</a></div></div></div></div>");var o=r.find("._popup");if(r.weekPicker("changeYear",(new Date).getFullYear()),r.find("input").on("change input",function(e){e.target.value=""}),r.find("._clear").on("click",function(){n.weekPicker.chosen=[],r.weekPicker("updateSelection")}),"single"!=this.weekPicker.mode){var d,k,l,h=r.children("div"),u=!1;h.on("mousedown","td",function(){u=!0;var e=a(this).data("week"),t=r.data("year");d=i().year(t).isoWeek(e).startOf("isoWeek"),l=!a(this).hasClass("_active")}),h.on("mousemove","td",function(){if(u){var e=a(this).data("week"),t=r.data("year");k=i().year(t).isoWeek(e).startOf("isoWeek"),r.weekPicker("setSelectedRange",d,k,l)}}),h.on("mouseup","td",function(){if(u=!1,d){var e=a(this).data("week"),t=r.data("year"),n=d,s=i().year(t).isoWeek(e).startOf("isoWeek"),c=s.isAfter(n),o=c?n:s,k=c?s:n;r.weekPicker("setRange",o,k,l)}}),h.on("touchstart","td",function(){u=!0;var e=a(this).data("week"),t=r.data("year");d=i().year(t).isoWeek(e).startOf("isoWeek"),l=!a(this).hasClass("_active")}),h.on("touchmove","td",function(e){if(u){var t=e.originalEvent.changedTouches[0],n=a(document.elementFromPoint(t.clientX,t.clientY)).data("week"),s=r.data("year");k=i().year(s).isoWeek(n).startOf("isoWeek"),r.weekPicker("setSelectedRange",d,k,l)}}),h.on("touchend","td",function(e){if(u=!1,d){var t=e.originalEvent.changedTouches[0],n=a(document.elementFromPoint(t.clientX,t.clientY)).data("week"),s=r.data("year"),c=d,o=i().year(s).isoWeek(n).startOf("isoWeek"),k=o.isAfter(c),h=k?c:o,f=k?o:c;r.weekPicker("setRange",h,f,l)}})}else r.children("div").on("click","td",function(){var e=a(this),i=e.hasClass("_active");r.find("._active").removeClass("_active"),i||e.addClass("_active");var s=e.data("week"),c=r.data("year");r.weekPicker("toggleWeek",s,c);var o=new CustomEvent("change",{detail:{range:[t(s,c)],mode:i?"deselect":"select"}});n.dispatchEvent(o)});r.on("dragstart","td",function(){return!1}),r.find("._oh").on("click","._arrow",function(e){var t=a(e.target).hasClass("_right"),i=Number(r.data("year"));r.weekPicker("changeYear",i+(t?1:-1))}),r.children().children().on("click focus",function(){o.show()}),a(document).on("click",function(e){var t=r.children().children();0!==t.find(e.target).length||t.is(e.target)||o.hide()}),r.on("keypress",function(e){"Enter"==e.code&&e.target})},clear:function(){this.weekPicker.chosen=[],a(this).weekPicker("updateSelection")},value:function(){return this.weekPicker.chosen},addDate:function(e){-1===this.weekPicker.chosen.indexOf(e)&&this.weekPicker.chosen.push(e)},removeDate:function(e){var t=this.weekPicker.chosen.indexOf(e);-1!==t&&this.weekPicker.chosen.splice(t,1)},setRange:function(e,t,i){for(var n=a(this),r=[];e<=t;)r.push(e.format("YYYY-MM-DD")),e.add(1,"week");r.forEach(function(e){n.weekPicker(i?"addDate":"removeDate",e)});var s=new CustomEvent("change",{detail:{range:r,mode:i?"select":"deselect"}});this.dispatchEvent(s),n.weekPicker("updateSelection")},setSelectedRange:function(e,t,i){var n=e.isoWeek(),r=t.isoWeek(),s=Math.min(n,r),c=Math.max(n,r),o=a(this).find("._weekTable td");o.removeClass("_rangeAdd _rangeDel"),o.slice(s-1,c).each(function(){a(this).addClass(i?"_rangeAdd":"_rangeDel")})},toggleWeek:function(e,t){var n=i().year(t).isoWeek(e).startOf("isoWeek").format("YYYY-MM-DD"),r=this.weekPicker.chosen.indexOf(n);-1!==r?this.weekPicker.chosen.splice(r,1):"single"==this.weekPicker.mode?this.weekPicker.chosen=[n]:this.weekPicker.chosen.push(n),a(this).weekPicker("updateInputVal")},updateSelection:function(){var e=a(this),t=e.find("table");t.empty();var n=e.data("year"),r=i().year(n).isoWeeksInYear();e.find("._yeardisp").text(n);for(var s,c=1;c<r+1;c++){c%7==1&&(t.append("<tr />"),s=t.find("tr").last());var o=-1!==this.weekPicker.chosen.indexOf(i().year(n).isoWeek(c).startOf("isoWeek").format("YYYY-MM-DD")),d=n==(new Date).getFullYear()&&c==i().isoWeek();s.append("<td class='"+(o?"_active ":"")+(d?"_current":"")+"' data-week='"+c+"'>"+c+"</td>")}e.weekPicker("updateInputVal")},changeYear:function(e){if(!e)throw new Error("need year");"string"==typeof e&&(e=Number(e));var t=a(this);t.data("year",e),t.weekPicker("updateSelection")},updateInputVal:function(){var t=a(this),n=e(t.data("locale")),r=t.find("input");if(0!==this.weekPicker.chosen.length)if("single"==this.weekPicker.mode){var s=i(this.weekPicker.chosen[0]);r.val(n.WEEK_SELECTED.replace("$weeknum",s.isoWeek()).replace("$year",s.year()))}else r.val(n.NUM_SELECTED.replace("$num_selected",this.weekPicker.chosen.length));else r.val("")}};return this.each(function(){this.weekPicker||(this.weekPicker={chosen:[],disabled:[]}),c[n]&&(r=c[n].apply(this,Array.prototype.slice.call(s,1)))}),r},a(document).ready(function(){a(".week-picker").each(function(){a(this).weekPicker("init")})})}();